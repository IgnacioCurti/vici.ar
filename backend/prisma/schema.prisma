generator client {
  provider = "prisma-client"
  output   = "../prisma/generated"
}

datasource db {
  provider = "postgresql"
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Users {
  user_id  BigInt  @id @default(autoincrement())
  username String
  UID      String? @unique @db.Uuid
  nickname String?

  // Relationships
  hostedEvents Events[] @relation("EventHost")
  eventParticipations EventsUsers[]
}

model Events {
  event_id BigInt @id @default(autoincrement())
  start_time DateTime
  end_time DateTime
  description String @db.Text
  game_id String @unique @db.Uuid
  host_id BigInt
  schedule_at DateTime @default(now())

  // Relationships
  host Users @relation("EventHost", fields: [host_id], references: [user_id], onDelete: Cascade)
  eventParticipants EventsUsers[]
}

model EventsUsers {
  event_id BigInt @id @default(autoincrement())
  user_id BigInt
  status EventUserStatus @default(PENDING)

  // Relationships
  event Events @relation(fields: [event_id], references: [event_id], onDelete: Cascade)
  user Users @relation(fields: [user_id], references: [user_id], onDelete: Cascade)

  @@index([event_id])
  @@index([user_id])

}

enum EventUserStatus {
  PENDING
  ACCEPTED
  DECLINED
  TENTATIVE
}
